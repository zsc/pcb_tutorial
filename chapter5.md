# 第5章：热设计与散热管理

## 章节大纲

1. **开篇介绍**
2. **热传导理论基础**
   - 傅里叶定律与热传导方程
   - 边界条件与初始条件
   - 稳态与瞬态分析
3. **热阻网络模型**
   - 串联与并联热阻
   - 多层PCB的热阻计算
   - 接触热阻与界面材料
4. **热通孔设计与铜皮散热**
   - 热通孔的等效热导率
   - 通孔阵列优化
   - 铜皮厚度与覆盖率计算
5. **对流散热计算**
   - 自然对流与强制对流
   - 努塞尔数与雷诺数
   - 散热器选型与优化
6. **热-电耦合仿真方法**
   - 功率密度分布
   - 温度依赖的电阻变化
   - 迭代求解算法
7. **案例研究：数据中心AI加速卡的液冷设计**
8. **高级话题：相变材料在动态热管理中的应用**
9. **本章小结**
10. **练习题**
11. **常见陷阱与错误**
12. **最佳实践检查清单**

---

## 开篇介绍

热设计是现代高性能PCB设计中的关键挑战之一。随着芯片功率密度的急剧增长——从早期CPU的10W/cm²到现代AI加速器超过100W/cm²——热管理已成为决定系统性能和可靠性的关键因素。本章将从热力学第一定律出发，建立PCB热设计的完整理论框架，并提供定量分析工具来优化散热方案。

对于AI科学家和程序员而言，理解热设计的重要性在于：温度直接影响芯片的时钟频率（热节流）、可靠性（Arrhenius方程预测的失效率）以及功耗（漏电流的指数增长）。一个优秀的热设计能够让你的算法在硬件上稳定运行于最高性能状态。

## 热传导理论基础

### 傅里叶定律与热传导方程

热传导的基本规律由傅里叶定律描述：

$$\vec{q} = -k \nabla T$$

其中：
- $\vec{q}$ 是热流密度矢量 [W/m²]
- $k$ 是材料的热导率 [W/(m·K)]
- $\nabla T$ 是温度梯度 [K/m]

结合能量守恒定律，我们得到三维非稳态热传导方程：

$$\rho c_p \frac{\partial T}{\partial t} = \nabla \cdot (k \nabla T) + \dot{q}_v$$

其中：
- $\rho$ 是材料密度 [kg/m³]
- $c_p$ 是比热容 [J/(kg·K)]
- $\dot{q}_v$ 是体积热源密度 [W/m³]
- $t$ 是时间 [s]

对于各向同性材料且热导率为常数的情况，方程简化为：

$$\frac{\partial T}{\partial t} = \alpha \nabla^2 T + \frac{\dot{q}_v}{\rho c_p}$$

其中 $\alpha = k/(\rho c_p)$ 是热扩散率 [m²/s]。

### PCB中的典型材料热参数

| 材料 | 热导率 k [W/(m·K)] | 密度 ρ [kg/m³] | 比热容 c_p [J/(kg·K)] | 热扩散率 α [mm²/s] |
|------|-------------------|----------------|----------------------|-------------------|
| 铜 | 385 | 8960 | 385 | 111.6 |
| FR-4（平面内） | 0.3 | 1850 | 1200 | 0.135 |
| FR-4（垂直） | 0.8 | 1850 | 1200 | 0.360 |
| 焊锡（SAC305） | 58 | 7400 | 220 | 35.6 |
| 空气（25°C） | 0.026 | 1.18 | 1005 | 22.0 |
| 硅 | 148 | 2330 | 712 | 89.2 |

### 边界条件类型

在PCB热分析中，常见的边界条件包括：

1. **第一类边界条件（Dirichlet）**：指定表面温度
   $$T|_{\Gamma} = T_s$$

2. **第二类边界条件（Neumann）**：指定热流密度
   $$-k\frac{\partial T}{\partial n}\bigg|_{\Gamma} = q_s$$

3. **第三类边界条件（Robin）**：对流换热
   $$-k\frac{\partial T}{\partial n}\bigg|_{\Gamma} = h(T - T_{\infty})$$

其中 $h$ 是对流换热系数 [W/(m²·K)]，$T_{\infty}$ 是环境温度。

### 稳态与瞬态分析

**稳态分析**适用于功率恒定且系统达到热平衡的情况：
$$\nabla \cdot (k \nabla T) + \dot{q}_v = 0$$

**瞬态分析**用于研究开机过程、功率突变或脉冲负载下的温度响应。对于突然施加的热源，温度响应可用格林函数方法求解：

$$T(r,t) - T_0 = \frac{Q}{8(\pi \alpha t)^{3/2}} \exp\left(-\frac{r^2}{4\alpha t}\right)$$

其中 $Q$ 是瞬时释放的热量 [J]，$r$ 是到热源的距离。

## 热阻网络模型

### 热阻的定义与计算

热阻（Thermal Resistance）定义为温差与热流功率的比值：

$$R_{th} = \frac{\Delta T}{P} = \frac{T_{hot} - T_{cold}}{P}$$

单位：[K/W] 或 [°C/W]

对于简单几何形状的热阻计算：

**平板热阻**：
$$R_{th} = \frac{L}{k \cdot A}$$

其中 $L$ 是厚度，$A$ 是横截面积。

**圆柱热阻**（径向）：
$$R_{th} = \frac{\ln(r_2/r_1)}{2\pi k L}$$

**球形热阻**：
$$R_{th} = \frac{1}{4\pi k}\left(\frac{1}{r_1} - \frac{1}{r_2}\right)$$

### 串联与并联热阻网络

热阻网络遵循与电阻网络相同的组合规则：

**串联热阻**：
$$R_{total} = R_1 + R_2 + R_3 + \cdots$$

**并联热阻**：
$$\frac{1}{R_{total}} = \frac{1}{R_1} + \frac{1}{R_2} + \frac{1}{R_3} + \cdots$$

### 多层PCB的综合热阻模型

考虑一个典型的4层板结构，从芯片到环境的热路径：

```
    芯片 (Junction)
         |
    [R_jc] 芯片到封装
         |
    [R_cs] 封装到PCB
         |
    ┌────┴────┐
    │         │
[R_cond]  [R_via]  传导与通孔并联
    │         │
    └────┬────┘
         |
    [R_conv] 对流到环境
         |
      环境温度
```

总热阻计算：
$$R_{ja} = R_{jc} + R_{cs} + \frac{R_{cond} \cdot R_{via}}{R_{cond} + R_{via}} + R_{conv}$$

### 各向异性材料的等效热导率

FR-4等层压材料表现出强烈的各向异性。等效热导率计算：

**平面内热导率**（铜层与介质并联）：
$$k_{xy} = f_{Cu} \cdot k_{Cu} + (1-f_{Cu}) \cdot k_{FR4,xy}$$

**垂直热导率**（铜层与介质串联）：
$$\frac{1}{k_z} = \frac{f_{Cu}}{k_{Cu}} + \frac{1-f_{Cu}}{k_{FR4,z}}$$

其中 $f_{Cu}$ 是铜的体积分数。

## 热通孔设计与铜皮散热

### 热通孔的等效热导率模型

单个镀铜通孔的热阻：
$$R_{via} = \frac{h}{\pi k_{eff} (r_o^2 - r_i^2)}$$

其中：
- $h$ 是板厚
- $r_o$ 是通孔外径
- $r_i$ 是通孔内径（未填充区域）
- $k_{eff}$ 是等效热导率

对于填充通孔：
$$k_{eff} = k_{Cu} \cdot \frac{\pi r_o^2}{\pi r_o^2} = k_{Cu}$$

对于未填充通孔（仅管壁镀铜）：
$$k_{eff} = k_{Cu} \cdot \frac{\pi(r_o^2 - r_i^2)}{\pi r_o^2} + k_{air} \cdot \frac{\pi r_i^2}{\pi r_o^2}$$

### 通孔阵列的优化设计

对于 $n \times m$ 的通孔阵列，考虑通孔间距 $s$ 的影响：

**有效热导率模型**：
$$k_{array} = k_{base} + n \cdot m \cdot \frac{k_{via} - k_{base}}{A_{total}} \cdot A_{via}$$

**最优间距计算**：
当 $s/d > 3$ 时，通孔间热耦合可忽略。最优设计准则：

$$s_{opt} = \sqrt{\frac{4k_{base}h}{\pi h_{conv}}}$$

其中 $h_{conv}$ 是对流换热系数。

### 铜皮散热设计

**热扩散半径**：
$$r_{spread} = \sqrt{\frac{k_{Cu} \cdot t_{Cu}}{h_{conv}}}$$

其中 $t_{Cu}$ 是铜箔厚度（典型值：1oz = 35μm）。

**有效散热面积**：
$$A_{eff} = \pi r_{spread}^2 \cdot \tanh\left(\frac{r_{actual}}{r_{spread}}\right)$$

**温升计算**：
$$\Delta T = \frac{P}{h_{conv} \cdot A_{eff} + G_{cond}}$$

其中 $G_{cond} = k_{Cu} \cdot t_{Cu} \cdot P_{perimeter}$ 是通过铜皮边缘的热导。

### 热通孔布局算法

基于Voronoi图的优化布局：

1. 将热源区域进行Delaunay三角剖分
2. 计算每个三角形的功率密度权重
3. 在质心位置放置热通孔
4. 迭代优化，使温度分布均匀化

热通孔密度函数：
$$\rho_{via}(x,y) = \rho_{min} + (\rho_{max} - \rho_{min}) \cdot \frac{q(x,y)}{q_{max}}$$

## 对流散热计算

### 自然对流与强制对流

对流换热的基本方程：
$$Q = h \cdot A \cdot (T_s - T_{\infty})$$

其中 $h$ 是对流换热系数，其值取决于流动状态。

### 自然对流换热系数

对于垂直平板的自然对流：

**层流区域** ($10^4 < Ra_L < 10^9$)：
$$Nu_L = 0.59 \cdot Ra_L^{1/4}$$

**湍流区域** ($Ra_L > 10^9$)：
$$Nu_L = 0.10 \cdot Ra_L^{1/3}$$

其中瑞利数（Rayleigh Number）：
$$Ra_L = \frac{g \beta (T_s - T_{\infty}) L^3}{\nu \alpha}$$

- $g$ = 9.81 m/s² （重力加速度）
- $\beta$ = 1/T （体积膨胀系数，对于理想气体）
- $L$ = 特征长度
- $\nu$ = 运动粘度
- $\alpha$ = 热扩散率

努塞尔数与换热系数的关系：
$$h = \frac{Nu_L \cdot k_{air}}{L}$$

**水平板的自然对流**：

热面朝上：
$$Nu_L = 0.54 \cdot Ra_L^{1/4} \quad (10^4 < Ra_L < 10^7)$$
$$Nu_L = 0.15 \cdot Ra_L^{1/3} \quad (10^7 < Ra_L < 10^{11})$$

热面朝下：
$$Nu_L = 0.27 \cdot Ra_L^{1/4} \quad (10^5 < Ra_L < 10^{10})$$

### 强制对流换热系数

**平板层流**（$Re_L < 5 \times 10^5$）：
$$Nu_L = 0.664 \cdot Re_L^{1/2} \cdot Pr^{1/3}$$

**平板湍流**（$Re_L > 5 \times 10^5$）：
$$Nu_L = 0.037 \cdot Re_L^{4/5} \cdot Pr^{1/3}$$

其中雷诺数：
$$Re_L = \frac{u \cdot L}{\nu}$$

普朗特数（空气在常温下 $Pr \approx 0.7$）：
$$Pr = \frac{\nu}{\alpha} = \frac{\mu c_p}{k}$$

### 散热器设计与优化

**肋片效率**：
$$\eta_{fin} = \frac{\tanh(mL)}{mL}$$

其中 $m = \sqrt{2h/(k_{fin} \cdot t_{fin})}$，$t_{fin}$ 是肋片厚度。

**总热阻**：
$$R_{heatsink} = \frac{1}{h \cdot A_{total} \cdot \eta_o}$$

其中总效率：
$$\eta_o = 1 - \frac{N \cdot A_{fin}}{A_{total}}(1 - \eta_{fin})$$

**最优肋片间距**（自然对流）：
$$s_{opt} = 2.714 \left(\frac{\nu^2 L}{g \beta \Delta T}\right)^{1/4}$$

对于强制对流，最优间距需要平衡压降与换热：
$$s_{opt} = \sqrt{\frac{2k_{fin} \cdot t_{fin} \cdot L}{h}}$$

## 热-电耦合仿真方法

### 温度依赖的电阻模型

铜的电阻率随温度变化：
$$\rho(T) = \rho_0[1 + \alpha(T - T_0)]$$

其中 $\alpha = 0.00393$ /K 是铜的温度系数。

功率耗散：
$$P = I^2 R(T) = I^2 \cdot \rho(T) \cdot \frac{L}{A}$$

### 耦合方程组

热-电耦合问题需要同时求解：

**电场方程**：
$$\nabla \cdot (\sigma(T) \nabla V) = 0$$

**热传导方程**：
$$\nabla \cdot (k \nabla T) + \sigma(T)|\nabla V|^2 = 0$$

其中 $\sigma(T) = 1/\rho(T)$ 是电导率。

### 迭代求解算法

1. **初始化**：设定初始温度分布 $T^{(0)}$
2. **求解电场**：基于 $T^{(n)}$ 计算电压分布和功率密度
3. **求解温度场**：使用更新的功率密度求解新的温度分布 $T^{(n+1)}$
4. **收敛判断**：
   $$\max|T^{(n+1)} - T^{(n)}| < \epsilon$$
5. **松弛因子**：为改善收敛性，使用：
   $$T^{(n+1)} = \omega T_{new} + (1-\omega)T^{(n)}$$
   
   其中 $0.5 < \omega < 1$ 是松弛因子。

### 功率密度分布优化

对于多热源系统，优化目标函数：
$$J = \int_{\Omega} (T - T_{target})^2 d\Omega + \lambda \int_{\Omega} |\nabla T|^2 d\Omega$$

第一项最小化温度偏差，第二项最小化温度梯度（热应力）。

## 案例研究：数据中心AI加速卡的液冷设计

### 项目背景

某数据中心部署的AI训练加速卡，单卡功耗达到700W，芯片结温不得超过85°C，环境温度35°C。传统风冷方案无法满足散热需求，需要设计液冷解决方案。

### 热负荷分析

**功率分布**：
- GPU核心：450W（面积：50mm × 50mm）
- HBM内存：8×20W = 160W
- VRM供电：90W（效率92%，自身损耗约70W）
- 其他：20W

**功率密度计算**：
$$q_{GPU} = \frac{450W}{50mm \times 50mm} = 180 W/cm^2$$

这远超风冷极限（约50W/cm²）。

### 液冷方案设计

**冷板设计参数**：
- 微通道尺寸：宽0.5mm，高3mm，间距0.3mm
- 通道数量：120条
- 冷板材质：紫铜（k = 385 W/(m·K)）
- 冷却液：25%乙二醇水溶液

**热阻链路分析**：

1. **芯片到冷板基底**：
   $$R_{TIM} = \frac{t_{TIM}}{k_{TIM} \cdot A_{chip}} = \frac{0.1mm}{5W/(m \cdot K) \times 2500mm^2} = 0.008 K/W$$

2. **冷板基底到流体**：
   $$R_{conv} = \frac{1}{h_{micro} \cdot A_{channel}}$$
   
   其中微通道对流换热系数：
   $$h_{micro} = \frac{Nu \cdot k_{fluid}}{D_h} \approx 25000 W/(m^2 \cdot K)$$
   
   $$R_{conv} = \frac{1}{25000 \times 120 \times (0.5 \times 3 \times 50)mm^2} = 0.018 K/W$$

3. **总热阻**：
   $$R_{total} = R_{TIM} + R_{base} + R_{conv} = 0.008 + 0.005 + 0.018 = 0.031 K/W$$

### 流量与压降计算

**所需流量**（基于温升5°C）：
$$\dot{m} = \frac{P}{c_p \Delta T} = \frac{700W}{4180 J/(kg \cdot K) \times 5K} = 0.0335 kg/s = 2.0 L/min$$

**压降计算**（Darcy-Weisbach方程）：
$$\Delta P = f \cdot \frac{L}{D_h} \cdot \frac{\rho v^2}{2}$$

其中：
- 摩擦系数 $f = 64/Re$（层流）
- 流速 $v = 2.22 m/s$
- $Re = 890$（层流）

$$\Delta P = 0.072 \times \frac{50mm}{1.2mm} \times \frac{1000 \times 2.22^2}{2} = 37 kPa$$

### 系统级热管理

**冷却液分配歧管设计**：
- 采用树状分支结构，确保各支路流量均匀
- Murray定律优化管径比：$d_p^3 = d_{d1}^3 + d_{d2}^3$

**冗余设计**：
- 双泵冗余，N+1配置
- 泄漏检测传感器
- 自动切换阀门

### 实测结果

- 芯片结温：78°C（设计裕量7°C）
- 冷板表面最大温差：3.2°C
- 系统COP（制冷效率）：15.2
- 年PUE贡献：0.046

## 高级话题：相变材料在动态热管理中的应用

### 相变材料基础理论

相变材料（PCM）利用固-液相变潜热进行热能存储：

$$Q_{stored} = m \cdot [c_s(T_m - T_i) + L_f + c_l(T_f - T_m)]$$

其中：
- $c_s$, $c_l$：固相和液相比热容
- $L_f$：熔化潜热
- $T_m$：熔点温度

### Stefan问题：相变界面移动

一维相变过程的Stefan方程：

$$\frac{\partial T}{\partial t} = \alpha \frac{\partial^2 T}{\partial x^2}$$

边界条件（相变界面）：
$$k_s \frac{\partial T_s}{\partial x} - k_l \frac{\partial T_l}{\partial x} = \rho L_f \frac{ds}{dt}$$

其中 $s(t)$ 是相变界面位置。

### PCM在PCB中的集成方案

**嵌入式PCM腔体**：
- 在高功率器件下方设计PCM储热腔
- 腔体尺寸优化：
  $$V_{PCM} = \frac{E_{pulse}}{\rho \cdot L_f \cdot \phi}$$
  
  其中 $\phi$ 是相变完成度（通常取0.8）

**增强传热结构**：
- 金属泡沫填充（提高有效热导率）
- 石墨烯增强（k > 1000 W/(m·K)）

### 动态热管理算法

**预测控制策略**：
1. 监测当前温度和功率
2. 预测未来热负荷轨迹
3. 优化PCM预充/放热时机

**状态空间模型**：
$$\begin{bmatrix} \dot{T}_{chip} \\ \dot{T}_{PCM} \\ \dot{\phi} \end{bmatrix} = \begin{bmatrix} -\frac{1}{R_1C_1} & \frac{1}{R_1C_1} & 0 \\ \frac{1}{R_1C_2} & -\frac{1}{R_1C_2} & 0 \\ 0 & f(T_{PCM}) & 0 \end{bmatrix} \begin{bmatrix} T_{chip} \\ T_{PCM} \\ \phi \end{bmatrix} + \begin{bmatrix} \frac{1}{C_1} \\ 0 \\ 0 \end{bmatrix} P$$

其中 $\phi$ 是液相分数，$f(T_{PCM})$ 是相变动力学函数。

### 应用实例：边缘AI设备

对于间歇性高负载的边缘推理设备：
- 推理时功率：150W，持续2秒
- 空闲功率：5W
- 占空比：5%

PCM设计：
- 材料：石蜡（n-Octadecane，Tm = 28°C，Lf = 244 kJ/kg）
- 质量：15g
- 储热能力：3.66 kJ
- 温度波动：±3°C（对比无PCM时±18°C）

## 本章小结

本章从傅里叶定律出发，系统地构建了PCB热设计的理论框架。关键要点包括：

**核心方程**：
- 热传导方程：$\rho c_p \frac{\partial T}{\partial t} = \nabla \cdot (k \nabla T) + \dot{q}_v$
- 热阻定义：$R_{th} = \Delta T / P$
- 对流换热：$Q = h \cdot A \cdot (T_s - T_{\infty})$

**关键设计参数**：
1. **热阻网络**：准确建模从芯片结到环境的完整热路径
2. **热通孔密度**：$\rho_{via} \propto q(x,y)$，根据功率密度优化分布
3. **对流系数**：自然对流 5-25 W/(m²·K)，强制对流 25-250 W/(m²·K)
4. **材料选择**：铜的热导率是FR-4的1000倍以上

**设计方法论**：
1. 从稳态分析开始，确定基本热阻要求
2. 进行瞬态分析，评估动态响应
3. 考虑热-电耦合，迭代优化
4. 引入先进技术（液冷、相变材料）应对极限挑战

**实践指导**：
- 功率密度超过50W/cm²时考虑液冷
- 热通孔间距保持3倍孔径以上避免热耦合
- 铜皮每增加1oz厚度，热扩散半径增加约40%
- PCM适用于脉冲负载，可减少60-80%的温度波动

记住：热设计不是事后补救，而应从概念设计阶段就纳入考虑。良好的热管理能够释放硬件的全部性能潜力。

## 练习题

### 基础题

**习题5.1** 一个BGA封装的FPGA芯片，功耗25W，封装尺寸35mm×35mm，安装在4层FR-4 PCB上。环境温度45°C，自然对流条件。计算芯片结温。给定：Rjc=1.2K/W，BGA焊球热阻0.8K/W，自然对流系数8W/(m²·K)。

*Hint: 建立完整的热阻链路，从结到环境。*

<details>
<summary>答案</summary>

总热阻链路：
- R_jc = 1.2 K/W
- R_BGA = 0.8 K/W  
- R_conv = 1/(h×A) = 1/(8×0.035×0.035) = 102 K/W

R_total = 1.2 + 0.8 + 102 = 104 K/W

结温：T_j = T_amb + P×R_total = 45 + 25×104 = 45 + 2600 = 2645°C

显然不合理！需要增加散热器或强制对流。实际上自然对流的热阻太大，必须采用其他散热方案。
</details>

**习题5.2** 设计一个热通孔阵列，将10W功率从顶层传导到底层。PCB厚度1.6mm，单个通孔直径0.3mm，壁厚35μm。要求温升不超过5°C。计算需要多少个通孔？

*Hint: 先计算单个通孔的热阻，然后用并联公式。*

<details>
<summary>答案</summary>

单个通孔热阻：
- 铜管壁面积：A = π×(r_o² - r_i²) = π×(0.15² - 0.115²) = 0.0295 mm²
- R_via = L/(k×A) = 1.6mm/(385 W/(m·K) × 0.0295×10⁻⁶ m²) = 140.8 K/W

要求总热阻：R_total = ΔT/P = 5/10 = 0.5 K/W

并联n个通孔：1/R_total = n/R_via
n = R_via/R_total = 140.8/0.5 = 282个通孔

实际设计可采用17×17的阵列（289个）。
</details>

**习题5.3** 某芯片在t=0时刻突然开启，功率100W，芯片热容50J/K。假设理想散热（热阻0.2K/W），计算达到稳态温度95%所需的时间。

*Hint: 一阶RC热路模型，时间常数τ=RC。*

<details>
<summary>答案</summary>

热RC电路：τ = R×C = 0.2 K/W × 50 J/K = 10秒

温度响应：T(t) = T_steady × (1 - e^(-t/τ))

达到95%：0.95 = 1 - e^(-t/10)
e^(-t/10) = 0.05
t = -10×ln(0.05) = 10×2.996 = 30秒

系统需要约30秒达到稳态温度的95%。
</details>

### 挑战题

**习题5.4** 推导微通道液冷散热器的最优通道宽度。考虑：(1)通道越窄，换热面积越大；(2)通道越窄，压降越大。给定总宽度W，通道高度H，流量Q恒定。

*Hint: 建立总热阻关于通道宽度的函数，求极值。*

<details>
<summary>答案</summary>

设通道宽度w，通道数n = W/(w+t)，其中t是壁厚。

对流热阻：R_conv ∝ 1/(h×A) ∝ 1/(Nu×n×w×H)
其中Nu ∝ Re^0.8 ∝ (v/w)^0.8 ∝ (Q/(n×w×H)×1/w)^0.8

压降：ΔP ∝ f×L×v²/D_h ∝ v²/w ∝ (Q/(n×w×H))²/w

优化问题：min(R_conv) s.t. ΔP < ΔP_max

经推导，最优通道宽度：
w_opt = (μ×Q×L/(ΔP_max×H×W))^(1/3)

典型值：w_opt ≈ 0.3-0.5mm（适用于大多数应用）。
</details>

**习题5.5** 某AI推理芯片有两种工作模式：推理时200W持续100ms，空闲时10W。设计一个PCM缓冲系统，使芯片温度波动不超过10°C。计算所需PCM质量。

*Hint: 能量平衡，PCM吸收脉冲能量。*

<details>
<summary>答案</summary>

脉冲能量：E_pulse = (P_peak - P_idle) × t = (200-10) × 0.1 = 19 J

稳态散热能力对应10W，额外190W需要PCM吸收。

PCM储热：Q = m × L_f × φ
其中φ是利用率，取0.7

选择石蜡（L_f = 200 kJ/kg）：
m = E_pulse/(L_f × φ) = 19/(200×10³ × 0.7) = 0.136 g

考虑安全系数2：m = 0.27 g

实际设计需考虑PCM的热导率增强，通常添加石墨或金属泡沫。
</details>

**习题5.6** 分析一个垂直安装的PCB（200mm×300mm），底部有3个发热芯片（各30W），顶部有2个芯片（各20W）。考虑自然对流的烟囱效应，计算各芯片的温升差异。

*Hint: 考虑边界层发展和浮力驱动流动。*

<details>
<summary>答案</summary>

自然对流边界层发展，局部换热系数：
h(x) = 0.59×(k/x)×(Ra_x)^0.25

底部芯片（x=50mm）：
Ra_x = g×β×ΔT×x³/(ν×α) ≈ 10^6
h_bottom ≈ 12 W/(m²·K)
ΔT_bottom = P/(h×A) = 30/(12×0.03×0.03) ≈ 28°C

顶部芯片（x=250mm，预热气流）：
有效温差降低，Ra增大但h降低
h_top ≈ 8 W/(m²·K)
ΔT_top = 20/(8×0.03×0.03) ≈ 28°C

但顶部环境温度已升高约15°C（烟囱效应）
实际温升：底部28°C，顶部43°C

结论：垂直PCB应将高功率器件置于底部。
</details>

**习题5.7** 设计一个用于1kW功率模块的均温板（Vapor Chamber）。工作温度80°C，使用水作为工质。计算：(1)最小腔体厚度；(2)毛细结构的渗透率要求；(3)传热极限。

*Hint: 考虑毛细极限、沸腾极限、音速极限等。*

<details>
<summary>答案</summary>

1. 最小腔体厚度（避免沸腾极限）：
   临界热流密度：q_crit = 0.14×h_fg×ρ_v×[σ×g×(ρ_l-ρ_v)]^0.25
   对于80°C的水：q_crit ≈ 150 W/cm²
   所需面积：A = 1000W / 150 W/cm² = 6.7 cm²
   取100mm×100mm，厚度>2mm避免干涸

2. 毛细结构渗透率（毛细极限）：
   K > (μ_l×L_eff×Q)/(ρ_l×h_fg×A_w×ΔP_cap)
   其中ΔP_cap = 2σ/r_pore
   典型烧结铜粉：K ≈ 10^-10 m²

3. 传热极限：
   Q_max = min(Q_capillary, Q_boiling, Q_sonic)
   - 毛细极限：~1500W（主要限制）
   - 沸腾极限：~3000W
   - 音速极限：~5000W

设计余量：1000W < 1500W，满足要求。
</details>

**习题5.8** 某量子计算控制电路板需要在4K低温环境下工作，功耗0.5W。从4K冷头到PCB的热连接使用高纯度铜带。设计铜带尺寸，使PCB温度不超过5K。考虑铜在低温下的热导率变化。

*Hint: 低温下铜的热导率显著提高，需查表或用Wiedemann-Franz定律。*

<details>
<summary>答案</summary>

低温铜热导率（RRR=100）：
- 4K: k ≈ 500 W/(m·K)
- 5K: k ≈ 600 W/(m·K)
- 平均：k_avg ≈ 550 W/(m·K)

热阻要求：R = ΔT/P = 1K/0.5W = 2 K/W

铜带热阻：R = L/(k×A)
设长度L=50mm（机械约束）：
A = L/(k×R) = 0.05/(550×2) = 4.5×10^-5 m² = 45 mm²

可选方案：
- 1mm厚×45mm宽铜带
- 0.5mm厚×90mm宽（更柔性）
- 多层0.1mm铜箔叠加（最柔性）

注意：需考虑接触热阻，使用铟焊或压接。
低温下还需考虑热收缩匹配。
</details>

## 常见陷阱与错误

### 1. 热阻计算错误
**错误**：简单相加所有热阻，忽略并联路径
**正确**：识别并联和串联关系，正确使用热阻网络

### 2. 忽视接触热阻
**错误**：假设完美接触，忽略界面热阻
**正确**：加入TIM材料，典型接触热阻0.1-1 cm²·K/W

### 3. 过度依赖仿真
**错误**：完全相信仿真结果，不留设计裕量
**正确**：仿真结果×1.3-1.5安全系数，并进行实测验证

### 4. 热通孔设计不当
**错误**：热通孔太少或分布不均
**正确**：根据热流密度分布优化通孔密度

### 5. 忽略环境因素
**错误**：使用25°C环境温度设计
**正确**：考虑最恶劣工况（高温、高海拔、密闭空间）

### 6. 材料参数误用
**错误**：使用常温下的材料参数
**正确**：考虑温度依赖性，特别是高温下性能退化

### 7. 瞬态响应低估
**错误**：只做稳态分析
**正确**：评估启动、关断、负载突变的瞬态响应

### 8. 热-机械应力忽视
**错误**：只关注温度，忽略热应力
**正确**：控制温度梯度，避免焊点疲劳

## 最佳实践检查清单

### 设计前期
- [ ] 明确功率预算和功率密度分布
- [ ] 确定环境条件（温度、海拔、通风）
- [ ] 设定温度目标（结温、壳温、板温）
- [ ] 评估可用的散热方案（被动/主动）

### 热阻分析
- [ ] 建立完整热阻网络模型
- [ ] 识别热阻瓶颈
- [ ] 计算各节点温度
- [ ] 验证是否满足降额要求

### PCB设计
- [ ] 热通孔数量充足（目标热阻）
- [ ] 铜皮面积最大化
- [ ] 高功率器件远离热敏感器件
- [ ] 考虑气流方向布局

### 热仿真
- [ ] 3D热模型包含所有热源
- [ ] 边界条件符合实际
- [ ] 网格细化验证
- [ ] 敏感性分析

### 散热方案
- [ ] 散热器选型计算
- [ ] TIM材料选择合适
- [ ] 安装压力优化
- [ ] 考虑长期可靠性

### 测试验证
- [ ] 温度测点布置合理
- [ ] 测试覆盖各种工况
- [ ] 热成像检查热点
- [ ] 加速老化测试

### 文档记录
- [ ] 热设计报告完整
- [ ] 假设条件明确
- [ ] 测试数据存档
- [ ] 设计改进建议

### 可靠性考虑
- [ ] 温度循环应力分析
- [ ] 功率循环寿命预测
- [ ] 失效模式分析（FMEA）
- [ ] 降额设计余量充足（>20%）